---
title: 闪电贷攻击
parent: DeFi 安全
nav_order: 1
---

# 闪电贷攻击

闪电贷允许无抵押借入大额资金，但可能被利用进行攻击。

## 什么是闪电贷？

闪电贷是无抵押贷款，必须在同一笔交易内偿还。

## 闪电贷攻击如何工作

1. 攻击者通过闪电贷借入大额资金
2. 使用资金操纵协议（例如，价格预言机）
3. 执行有利可图的交易
4. 偿还闪电贷
5. 保留利润

## 真实案例

- bZx 协议攻击（2020）
- Harvest Finance 漏洞利用（2020）
- Value DeFi 攻击（2020）

## 缓解策略

### 对于用户

- 了解闪电贷风险
- 监控协议 TVL 和活动
- 使用具有闪电贷保护的协议

### 对于开发者

- 不要仅依赖现货价格
- 使用时间加权平均价格（TWAP）
- 实现熔断机制
- 为关键操作添加延迟
- 使用多个价格来源

## 代码示例

```solidity
// 易受攻击：使用现货价格
uint256 price = oracle.getPrice(token);

// 更好：使用 TWAP
uint256 price = oracle.getTWAP(token, 1 hours);
```
